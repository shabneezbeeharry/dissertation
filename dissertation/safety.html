<!DOCTYPE html>
<html lang="en">
	<head>
	  <meta charset="UTF-8">
	  <title>MauFlood | Safety & Emergency</title>
	  <meta name="viewport" content="width=device-width, initial-scale=1.0">

	  <!-- Font Awesome -->
	  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

	  <!-- Main CSS -->
	  <link rel="stylesheet" href="css/style.css">
	  <link rel="stylesheet" href="css/safety.css">
	</head>

	<body>
		<div class="container">

		  <!-- NAVBAR -->
		  <nav class="navbar">
			<div class="nav-logo">
			  <i class="fas fa-tint"></i> MauFlood
			</div>
			<ul class="nav-links">
			  <li><a href="index.html"><i class="fas fa-home"></i> Home</a></li>
			  <li><a href="dashboard.html"><i class="fas fa-chart-line"></i> Dashboard</a></li>
			  <li><a href="safety.html" class="active"><i class="fas fa-shield-alt"></i> Safety</a></li>
			</ul>
		  </nav>

		  <!-- HEADER -->
		  <header>
			<h1><i class="fas fa-shield-alt title-icon"></i> Safety & Emergency Guide</h1>
			<p class="subtitle">Protecting lives during floods and droughts in Mauritius</p>
		  </header>

		  <!-- SAFETY GRID -->
		  <div class="safety-grid">

			<!-- FLOOD -->
			<div class="safety-card flood">
			  <h2><i class="fas fa-water"></i> During a Flood</h2>
			  <ul>
				<li>Move to higher ground immediately.</li>
				<li>Never walk or drive through floodwater.</li>
				<li>Switch off electricity at the main breaker.</li>
				<li>Keep emergency supplies ready.</li>
				<li>Listen to official warnings and alerts.</li>
			  </ul>
			</div>

			<!-- DROUGHT -->
			<div class="safety-card drought">
			  <h2><i class="fas fa-sun"></i> During a Drought</h2>
			  <ul>
				<li>Use water sparingly and responsibly.</li>
				<li>Store clean drinking water safely.</li>
				<li>Fix leaks and dripping taps.</li>
				<li>Avoid non-essential water use.</li>
				<li>Follow water authority guidelines.</li>
			  </ul>
			</div>

			<!-- EMERGENCY -->
				<div class="safety-card emergency">
				  <h2><i class="fas fa-phone-alt"></i> Emergency Numbers</h2>

				  <div class="emergency-grid">

					<a href="tel:999" class="emergency-box">
					  <i class="fas fa-shield-halved"></i>
					  Police<br>148 / 999
					</a>

					<a href="tel:114" class="emergency-box">
					  <i class="fas fa-ambulance"></i>
					  Ambulance (SAMU)<br>114
					</a>

					<a href="tel:115" class="emergency-box">
					  <i class="fas fa-fire-extinguisher"></i>
					  Fire Brigade<br>115
					</a>

					<a href="tel:8996" class="emergency-box">
					  <i class="fas fa-building-shield"></i>
					  NEOC<br>8996
					</a>

				  </div>
				</div>

		  </div>

		  <!-- SHELTER INFO -->
		  <div class="highlight">
			<h2><i class="fas fa-people-roof"></i> Nearby Shelter & Support Areas</h2>
			<p>
			  <strong>Port Louis:</strong> Community centres, NGOs, schools<br>
			  <strong>Flacq:</strong> Social Welfare Centres, Fire Station<br>
			 <strong>Rivière du Poste:</strong> Community centres, government schools, social welfare centres
			</p>
			<p style="margin-top:10px;font-size:0.9em;">
			  Shelters are activated by authorities during emergencies.
			  </p>
			    <h2><i class="fas fa-people-roof"></i> Nearby Shelters</h2>
    <p id="distance">Click a shelter to calculate distance.</p>

    <button class="shelter-btn" onclick="handleShelter('portlouis')">Port Louis</button>
    <button class="shelter-btn" onclick="handleShelter('flacq')">Flacq</button>
    <button class="shelter-btn" onclick="handleShelter('riviere')">Rivière du Poste</button>
    
    <p>
      <button class="shelter-btn" id="directions-btn" style="display:none;" onclick="openDirections()">
        Open Directions in Google Maps
      </button>
    </p>
		  </div>

		  <!-- MAP -->
		  <section class="card">
			<h2><i class="fas fa-map-marked-alt"></i> Emergency Reference Map</h2>
			<p>Key regions where emergency coordination and shelters may be activated.</p>

			<div class="map-container">
			  <iframe
			   src="https://www.google.com/maps?q=Port+Louis+Mauritius|Flacq+Mauritius|Riviere+du+Poste+Mauritius&z=9&output=embed"
				width="100%"
				height="420"
				style="border:0;"
				allowfullscreen
				loading="lazy"
				referrerpolicy="no-referrer-when-downgrade">
			  </iframe>
			</div>
		  </section>

		  <!-- FOOTER -->
		  <div class="footer">
		   <div class="footer">Disclaimer:This system provides alerts based on sensor data and is intended
						for informational purposes only. Always follow official authorities'
						instructions during emergencies.
						Emergency: NEOC 8996 | Police 999 | Ambulance 114</div>
		  </div>

		</div>
		
<script>
  // Shelter Coordinates
  const shelters = {
    portlouis: { lat: -20.1609, lng: 57.5012, name: "Port Louis Shelter" },
    flacq: { lat: -20.1903, lng: 57.7142, name: "Flacq Shelter" },
    riviere: { lat:  -20.4446465, lng:  57.5961049, name: "Rivière du Poste Shelter" }
  };

  function calculateDistance(lat1, lon1, lat2, lon2) {
    const R = 6371;
    const dLat = (lat2 - lat1) * Math.PI / 180;
    const dLon = (lon2 - lon1) * Math.PI / 180;

    const a =
      Math.sin(dLat/2)**2 +
      Math.cos(lat1 * Math.PI / 180) *
      Math.cos(lat2 * Math.PI / 180) *
      Math.sin(dLon/2)**2;

    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    return R * c;
  }

  function handleShelter(key) {
    const shelter = shelters[key];
    const output = document.getElementById("distance");

    if (!navigator.geolocation) {
      output.innerText = "Geolocation not supported.";
      return;
    }

    navigator.geolocation.getCurrentPosition(
      function(position) {
        const userLat = position.coords.latitude;
        const userLng = position.coords.longitude;

        const distance = calculateDistance(userLat, userLng, shelter.lat, shelter.lng);

        output.innerText = `${shelter.name} is ${distance.toFixed(2)} km away from you.`;

        // Open Google Maps directions in new tab
        window.open(
          `https://www.google.com/maps/dir/?api=1&destination=${shelter.lat},${shelter.lng}`,
          "_blank"
        );
      },
      function() {
        output.innerText = "Please allow location access.";
      }
    );
  }
</script>
	</body>
</html>
